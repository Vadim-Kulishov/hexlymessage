(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{110:function(e,t,s){"use strict";s.r(t);var a=s(59),n=s(1),c=s(24),r=s(68),l=(s(79),s(80),s(30)),j=s(11),o=s(113),i=s(60),d=s.n(i),m=s(74);const b=(e,t)=>{const[s,a]=Object(n.useState)((()=>{const s=window.localStorage.getItem(e);return s?JSON.parse(s):t}));return Object(n.useEffect)((()=>{const t=JSON.stringify(s);window.localStorage.setItem(e,t)}),[s]),[s,a]},u=e=>{const t=t=>{let s;return s="function"===typeof e?e(t):e,s&&(t.preventDefault(),t.returnValue=s),s};Object(n.useEffect)((()=>(window.addEventListener("beforeunload",t),()=>window.removeEventListener("beforeunload",t))),[])};var x=s(115),O=s(118),h=s(5);var g=s(116),v=s(61),p=s.n(v),f=s(117),y=s(62);const N=e=>{let{msg:t,removeMessage:s}=e;const{messageId:a,messageText:n,senderName:c,createdAt:r,currentUser:l}=t;return Object(h.jsx)(g.a.Item,{className:"d-flex ".concat(l?"justify-content-end":""),children:Object(h.jsxs)(f.a,{bg:"".concat(l?"primary":"secondary"),text:"light",style:{width:"55%"},children:[Object(h.jsxs)(f.a.Header,{className:"d-flex justify-content-between align-items-center",children:[Object(h.jsx)(f.a.Text,{as:p.a,date:r,className:"small"}),Object(h.jsx)(f.a.Text,{children:c})]}),Object(h.jsxs)(f.a.Body,{className:"d-flex justify-content-between align-items-center",children:[Object(h.jsx)(f.a.Text,{children:n}),l&&Object(h.jsx)(O.a,{variant:"none",className:"text-warning",onClick:()=>{s(a)},children:Object(h.jsx)(y.a,{})})]})]})})},w={height:"80vh",border:"1px solid rgba(0,0,0,.4)",borderRadius:"4px",overflow:"auto"},C=e=>{let{messages:t,removeMessage:s}=e;const a=Object(n.useRef)(null);return Object(n.useEffect)((()=>{var e;null===(e=a.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[t]),Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(g.a,{variant:"flush",style:w,children:[t.map((e=>Object(h.jsx)(N,{msg:e,removeMessage:s},e.messageId))),Object(h.jsx)("span",{ref:a})]})})};var I=s(72),S=s(64),M=s(63);const T=e=>{let{username:t,sendMessage:s}=e;const[a,c]=Object(n.useState)(""),[r,l]=Object(n.useState)(!1);return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(x.a,{onSubmit:e=>{e.preventDefault();a.trim()&&(s({messageText:a,senderName:t}),c(""))},children:Object(h.jsxs)(x.a.Group,{className:"d-flex",children:[Object(h.jsx)(O.a,{variant:"primary",type:"button",onClick:()=>{l((e=>!e))},children:Object(h.jsx)(M.a,{})}),Object(h.jsx)(x.a.Control,{value:a,onChange:e=>{c(e.target.value)},type:"text",placeholder:"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435..."}),Object(h.jsx)(O.a,{variant:"success",type:"submit",children:Object(h.jsx)(S.a,{})})]})}),r&&Object(h.jsx)(I.a,{onSelect:e=>{c((t=>t+e.native))},emojiSize:20})]})};var E=s(114),J=s(112),R=s(67);const k=e=>{let{users:t}=e;const s=Object.entries(t),a=Object.values(t).filter((e=>e.online)).length;return Object(h.jsx)(E.a,{className:"mt-4",children:Object(h.jsxs)(f.a,{children:[Object(h.jsx)(f.a.Header,{bg:"none",children:Object(h.jsxs)(E.a.Toggle,{as:O.a,variant:"info",eventKey:"0",style:{textDecoration:"none"},children:["\u0410\u043a\u0442\u0438\u0432\u043d\u044b\u0435 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438"," ",Object(h.jsx)(J.a,{variant:"light",className:"ml-1",children:a})]})}),s.map((e=>{let[t,s]=e;return Object(h.jsx)(E.a.Collapse,{eventKey:"0",children:Object(h.jsxs)(f.a.Body,{children:[Object(h.jsx)(R.a,{className:"mb-1 ".concat(s.online?"text-success":"text-secondary"),size:"0.8em"})," ",s.username]})},t)}))]})})},D=[{path:"/",name:"Home",Component:function(){const[e,t]=b("username","John"),[s,a]=Object(n.useState)("free"),c=Object(n.useRef)(null),r=e.trim();return Object(h.jsxs)(x.a,{className:"mt-5",style:{maxWidth:"320px",margin:"0 auto"},onSubmit:e=>{e.preventDefault(),c.current.click()},children:[Object(h.jsxs)(x.a.Group,{children:[Object(h.jsx)(x.a.Label,{children:"Name:"}),Object(h.jsx)(x.a.Control,{value:e,onChange:e=>{t(e.target.value)}})]}),Object(h.jsxs)(x.a.Group,{children:[Object(h.jsx)(x.a.Label,{children:"Room:"}),Object(h.jsxs)(x.a.Control,{as:"select",value:s,onChange:e=>{a(e.target.value)},children:[Object(h.jsx)("option",{value:"free",children:"Free"}),Object(h.jsx)("option",{value:"job",disabled:!0,children:"Job"})]})]}),r&&Object(h.jsx)(O.a,{variant:"success",as:l.b,to:"/".concat(s),ref:c,children:"Chat"})]})}},{path:"/:roomId",name:"ChatRoom",Component:()=>{const{roomId:e}=Object(j.f)(),{users:t,messages:s,sendMessage:a,removeMessage:c}=(e=>{const[t,s]=Object(n.useState)([]),[a,c]=Object(n.useState)([]),[r]=b("userId",Object(m.a)(8)),[l]=b("username"),j=Object(n.useRef)(null);return Object(n.useEffect)((()=>(j.current=d()("http://localhost:5000",{query:{roomId:e}}),j.current.emit("user:add",{username:l,userId:r}),j.current.on("users",(e=>{s(e)})),j.current.emit("message:get"),j.current.on("messages",(e=>{const t=e.map((e=>e.userId===r?{...e,currentUser:!0}:e));c(t)})),()=>{j.current.disconnect()})),[e,r,l]),u((()=>{j.current.emit("user:leave",r)})),{users:t,messages:a,sendMessage:e=>{let{messageText:t,senderName:s}=e;j.current.emit("message:add",{userId:r,messageText:t,senderName:s})},removeMessage:e=>{j.current.emit("message:remove",e)}}})(e);return Object(n.useEffect)((()=>()=>{a({messageText:"",senderName:""})}),[]),Object(h.jsx)("div",{className:"mt-4",children:Object(h.jsxs)("div",{className:"row",children:[Object(h.jsxs)("div",{className:"col-md-8",children:[Object(h.jsx)(C,{messages:s,removeMessage:c}),Object(h.jsx)(T,{username:"user",sendMessage:a})]}),Object(h.jsx)("div",{className:"col-md-4",children:Object(h.jsx)(k,{users:t})})]})})}}],F=()=>Object(h.jsx)(l.a,{children:Object(h.jsxs)(o.a,{style:{maxWidth:"512px"},children:[Object(h.jsx)("h1",{className:"mt-2 text-center",children:"Message Hexlet"}),Object(h.jsx)(j.c,{children:D.map((e=>{let{path:t,Component:s}=e;return Object(h.jsx)(j.a,{path:t,exact:!0,children:Object(h.jsx)(s,{})},t)}))})]})});var H;const L=Object(r.a)(H||(H=Object(a.a)(["\n.card-header {\n  padding: 0.25em 0.5em;\n}\n.card-body {\n  padding: 0.25em 0.5em;\n}\n.card-text {\n  margin: 0;\n}\n"]))),B=document.getElementById("root");Object(c.render)(Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(L,{}),Object(h.jsx)(F,{})]}),B)}},[[110,1,2]]]);
//# sourceMappingURL=main.40064153.chunk.js.map